<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Svedala Info - Digital Signage</title>
    <style>
        :root {
            /* F√§rgtema: Modern Sk√•ne */
            --bg-color: #002b5c;       /* Djup marinbl√• */
            --text-color: #f8f9fa;     /* N√§stan vit */
            --accent-color: #ffcc00;   /* Solgul */
            --box-bg: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Segoe UI', Roboto, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            overflow: hidden;
        }

        .container {
            width: 85%;
            max-width: 1200px;
            padding: 50px;
            border-radius: 30px;
            background: var(--box-bg);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: fadeIn 1.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 { 
            font-size: 2.5rem; 
            margin-bottom: 0; 
            text-transform: uppercase; 
            letter-spacing: 2px;
            opacity: 0.9;
        }

        .date-large { 
            font-size: 4rem; 
            font-weight: 800; 
            margin: 10px 0 30px 0;
            color: var(--accent-color);
        }
        
        .namnsdag-section {
            margin-bottom: 40px;
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .label { font-size: 1.4rem; opacity: 0.7; text-transform: uppercase; }
        .value { font-size: 3rem; font-weight: bold; margin-top: 10px; }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 20px;
        }

        .info-box {
            background: rgba(0, 0, 0, 0.2);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .trend {
            margin-top: 50px;
            font-size: 2rem;
            font-weight: 500;
            color: var(--accent-color);
            background: rgba(255, 204, 0, 0.1);
            padding: 20px;
            border-radius: 15px;
            display: inline-block;
        }
    </style>
</head>
<body>

<div class="container">
    <h1 id="weekday">Laddar...</h1>
    <div id="date-string" class="date-large">-- --- ----</div>

    <div class="namnsdag-section">
        <div class="label">Dagens namnsdag</div>
        <div id="namnsdag" class="value">...</div>
    </div>

    <div class="info-grid">
        <div class="info-box">
            <div class="label">‚òÄÔ∏è Solen g√•r upp</div>
            <div id="sunrise" class="value">--:--</div>
        </div>
        <div class="info-box">
            <div class="label">üåô Solen g√•r ned</div>
            <div id="sunset" class="value">--:--</div>
        </div>
    </div>

    <div id="change-text" class="trend">
        Ber√§knar ljusets √•terkomst...
    </div>
</div>

<script>
    // Koordinater f√∂r Svedala
    const lat = 55.5074;
    const lng = 13.2351;

    async function updateDashboard() {
        const now = new Date();
        
        // 1. Uppdatera Datum
        const dayOptions = { weekday: 'long' };
        const dateOptions = { day: 'numeric', month: 'long', year: 'numeric' };
        document.getElementById('weekday').innerText = now.toLocaleDateString('sv-SE', dayOptions);
        document.getElementById('date-string').innerText = now.toLocaleDateString('sv-SE', dateOptions);

        // 2. H√§mta Namnsdag
        try {
            const res = await fetch('https://sholiday.fabianbeiner.com/v1/today');
            const data = await res.json();
            const names = data.holidays.map(h => h.name).join(' & ');
            document.getElementById('namnsdag').innerText = names || "Ingen speciell idag";
        } catch (e) { 
            document.getElementById('namnsdag').innerText = "Hittade inga namn"; 
        }

        // 3. H√§mta Soltider (Idag och 7 dagar sen)
        try {
            // Idag
            const resToday = await fetch(`https://api.sunrise-sunset.org/json?lat=${lat}&lng=${lng}&formatted=0`);
            const dataToday = await resToday.json();
            
            // F√∂r en vecka sedan
            const pastDate = new Date();
            pastDate.setDate(pastDate.getDate() - 7);
            const dateStr = pastDate.toISOString().split('T')[0];
            const resPast = await fetch(`https://api.sunrise-sunset.org/json?lat=${lat}&lng=${lng}&date=${dateStr}&formatted=0`);
            const dataPast = await resPast.json();

            // Tidshantering (konvertera till lokal tid)
            const formatTime = (isoStr) => {
                const d = new Date(isoStr);
                return d.toLocaleTimeString('sv-SE', { hour: '2-digit', minute: '2-digit' });
            };

            document.getElementById('sunrise').innerText = formatTime(dataToday.results.sunrise);
            document.getElementById('sunset').innerText = formatTime(dataToday.results.sunset);

            // Ber√§kna skillnad
            const lengthToday = dataToday.results.day_length;
            const lengthPast = dataPast.results.day_length;
            const diffMinutes = Math.round((lengthToday - lengthPast) / 60);

            const trendDiv = document.getElementById('change-text');
            if (diffMinutes > 0) {
                trendDiv.innerHTML = `‚òÄÔ∏è Dagen √§r <strong>${diffMinutes} minuter l√§ngre</strong> √§n f√∂rra veckan!`;
            } else if (diffMinutes < 0) {
                trendDiv.innerHTML = `üåô Dagen √§r <strong>${Math.abs(diffMinutes)} minuter kortare</strong> √§n f√∂rra veckan.`;
            } else {
                trendDiv.innerText = `Samma dagsl√§ngd som f√∂rra veckan.`;
            }

        } catch (e) {
            document.getElementById('change-text').innerText = "Kunde inte h√§mta soltider just nu.";
        }
    }

    updateDashboard();
    // Uppdatera sidan var 12:e timme f√∂r att h√•lla den fr√§sch
    setInterval(updateDashboard, 1000 * 60 * 60 * 12);
</script>

</body>
</html>
